# RDE-DA-SHRED Submission Bundle

This directory contains the implementation and data files for the rotating detonation engine (RDE) simulation and data-driven modeling project that the Cheap2Rich pipeline targets.

## Contents

### Main Implementation Files

- **`Cheap2Rich.py`** - Core implementation of the data-driven model that transforms low-fidelity simulations into high-fidelity predictions using LF/HF SHRED modules.
- **`baselines_for_results.ipynb`** - Notebook with earlier baseline experiments and visualization helpers.

### Data Files

- **`high_fidelity_1d_dataset.npy`** - High-fidelity 1D RDE dataset (full-resolution time series).
- **`Kochs_model_dataset.npy`** - Raw data generated by the Koch-based low-fidelity model.
- **`high_fidelity_sim_processed.npy`** / **`Koch_model_processed.npy`** - Preprocessed versions used by `Cheap2Rich.py`.

### Configuration

- **`requirements.txt`** - Python dependencies for reproducing all pipelines and discovery scripts.

### Koch Model Generation

The `Koch_model_data_generation/` folder implements the 1D Euler solver, demo simulations, and instructions for rebuilding the Koch dataset if needed.

### Quick Start

1. Install the environment (pip inside the bundled `venv` is preconfigured):
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    pip install -r requirements.txt
    ```
2. Run `python Cheap2Rich.py` to train the LF/HF SHRED pipelines on the provided datasets.
3. Optional: explore the discovery scripts under `scripts/` after installing their dependencies (`pysindy` for SINDy, SciPy + scikit-learn for the MAMBA script).

## Architectural Highlights

- **Temporal-convolution front-end.** Sensor histories first pass through a small convolutional block so the HF SHRED LSTM sees multi-resolution temporal context instead of raw samples.
- **Gated HF residual.** The HF decoder now learns a sigmoid gate plus optional frequency-domain attention so it only injects high-frequency corrections where they help, avoiding overcorrection.
- **Contrastive alignment (`contrastive-latent`).** The branch eschews the latent GAN in favor of projection-based contrastive alignment, matching or beating RMSE/SSIM while training faster and without adversarial instability.
- **Fourier-frequency gating (`frequency-attn`).** An experimental layer modulates HF corrections in the Fourier domain per-frequency bin, promoting smoother energy distributions and better generalization.

## Key Results (main branch)

- LF-SHRED baseline RMSE on the real dataset: `0.4105`.
- LF + HF RMSE (main pipeline): `0.1067` (~93% improvement).
- Validation SSIM (sim / LF / LF+HF): `0.1808 / 0.1762 / 0.3265`.
- Full dataset SSIM: `0.1038 / 0.1159 / 0.3574`.
- Reconstruction plots are saved under `reports/` (e.g., `RDE_four_panel_comparison.png`, `sparse_freq_RDE_results.png`).

## Discovery Workflows

### SINDy Discovery (`sindy-discovery` branch)

Runs PySINDy on Koch, high-fidelity, and residual fields, exposing polynomial/interaction-heavy equations. Results live under `reports/sindy_results.*`, and derivative reconstruction plots are saved as `reports/sindy_<Label>.png`.

### MAMBA-style Multi-scale Discovery (`mamba-discovery` branch)

Constructs multi-scale Ricker-like features per sensor, fits a ridge model to the derivative, then reports best coefficients and metrics in `reports/mamba_results.*`. Forecast vs. derivative plots for each dataset are also saved to the same directory.

## Next Steps

- Examine the `contrastive-latent` branch to compare latent alignment strategies and the `frequency-attn` branch to evaluate frequency-domain gating.
- Review the generated reports (`reports/`) for SINDy and MAMBA to understand the discovered governing structures.
- Use the `scripts/` helpers to rerun discovery with other sensor selections or lower sparsity thresholds.
